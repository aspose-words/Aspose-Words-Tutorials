---
category: general
date: 2025-12-23
description: Äáº·t cháº¿ Ä‘á»™ khÃ´i phá»¥c Ä‘á»ƒ phá»¥c há»“i cÃ¡c tÃ i liá»‡u Word bá»‹ há»ng. TÃ¬m hiá»ƒu
  cÃ¡ch má»Ÿ tá»‡p DOCX, sá»­ dá»¥ng cháº¿ Ä‘á»™ khÃ´i phá»¥c vÃ  xá»­ lÃ½ cÃ¡c tá»‡p bá»‹ há»ng trong Java.
draft: false
keywords:
- set recovery mode
- recover damaged word
- how to open docx
- open corrupted word file
- use recovery mode
language: vi
og_description: Äáº·t cháº¿ Ä‘á»™ khÃ´i phá»¥c Ä‘á»ƒ phá»¥c há»“i cÃ¡c tÃ i liá»‡u Word bá»‹ há»ng. HÆ°á»›ng
  dáº«n nÃ y chá»‰ cÃ¡ch má»Ÿ tá»‡p DOCX, sá»­ dá»¥ng cháº¿ Ä‘á»™ khÃ´i phá»¥c vÃ  xá»­ lÃ½ cÃ¡c tá»‡p bá»‹ há»ng
  trong Java.
og_title: CÃ i Äáº·t Cháº¿ Äá»™ Phá»¥c Há»“i â€“ Má»Ÿ CÃ¡c Tá»‡p Word Bá»‹ Há»ng trong Java
tags:
- Java
- Aspose.Words
- Document Recovery
title: CÃ i Äáº·t Cháº¿ Äá»™ KhÃ´i Phá»¥c â€“ CÃ¡ch Má»Ÿ CÃ¡c Tá»‡p Word Bá»‹ Há»ng trong Java
url: /vi/java/document-loading-and-saving/set-recovery-mode-how-to-open-corrupted-word-files-in-java/
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# Äáº·t Cháº¿ Äá»™ Phá»¥c Há»“i â€“ CÃ¡ch Má»Ÿ Tá»‡p Word Bá»‹ Há»ng trong Java

Báº¡n Ä‘Ã£ bao giá» **Ä‘áº·t cháº¿ Ä‘á»™ phá»¥c há»“i** cho má»™t tÃ i liá»‡u Word mÃ  khÃ´ng má»Ÿ Ä‘Æ°á»£c chÆ°a? Báº¡n khÃ´ng pháº£i lÃ  ngÆ°á»i duy nháº¥t. Nhiá»u nhÃ  phÃ¡t triá»ƒn gáº·p khÃ³ khÄƒn khi má»™t tá»‡p DOCX bá»‹ há»ng má»™t chÃºt vÃ  lá»‡nh `new Document("file.docx")` nÃ©m ra ngoáº¡i lá»‡. Tin tá»‘t? Aspose.Words for Java cung cáº¥p má»™t cÃ¡ch tÃ­ch há»£p Ä‘á»ƒ **sá»­ dá»¥ng cháº¿ Ä‘á»™ phá»¥c há»“i** vÃ  thá»±c sá»± **khÃ´i phá»¥c cÃ¡c tá»‡p Word bá»‹ há»ng**.

Trong hÆ°á»›ng dáº«n nÃ y, chÃºng ta sáº½ Ä‘i qua má»i thá»© báº¡n cáº§n biáº¿t Ä‘á»ƒ **má»Ÿ tá»‡p word bá»‹ há»ng** má»™t cÃ¡ch an toÃ n, tá»« viá»‡c cáº¥u hÃ¬nh `LoadOptions` Ä‘áº¿n xá»­ lÃ½ cÃ¡c trÆ°á»ng há»£p gÃ³c mÃ  thÆ°á»ng lÃ m ngÆ°á»i dÃ¹ng bá»‘i rá»‘i. KhÃ´ng cÃ³ pháº§n thá»«aâ€”chá»‰ cÃ³ giáº£i phÃ¡p thá»±c táº¿, tá»«ng bÆ°á»›c mÃ  báº¡n cÃ³ thá»ƒ dÃ¡n vÃ o dá»± Ã¡n ngay láº­p tá»©c.

> **Máº¹o chuyÃªn nghiá»‡p:** Náº¿u báº¡n chá»‰ gáº·p cÃ¡c lá»—i nhá» (nhÆ° thiáº¿u footer), cháº¿ Ä‘á»™ phá»¥c há»“i **Tolerant** thÆ°á»ng lÃ  Ä‘á»§. DÃ nh **Strict** cho nhá»¯ng tÃ¬nh huá»‘ng báº¡n cáº§n tÃ i liá»‡u sáº¡ch 100â€¯% trÆ°á»›c khi xá»­ lÃ½.

## Nhá»¯ng GÃ¬ Báº¡n Cáº§n Chuáº©n Bá»‹

- **Javaâ€¯17** (hoáº·c báº¥t ká»³ JDK má»›i nÃ o; API hoáº¡t Ä‘á»™ng tÆ°Æ¡ng tá»±)
- **Aspose.Words for Java**â€¯23.9 (hoáº·c má»›i hÆ¡n) â€“ thÆ° viá»‡n cung cáº¥p lá»›p `LoadOptions`.
- Má»™t tá»‡p **DOCX bá»‹ há»ng** Ä‘á»ƒ thá»­ nghiá»‡m (báº¡n cÃ³ thá»ƒ táº¡o báº±ng cÃ¡ch cáº¯t ngáº¯n má»™t tá»‡p há»£p lá»‡ báº±ng trÃ¬nh chá»‰nh sá»­a hex).
- IDE yÃªu thÃ­ch cá»§a báº¡n (IntelliJ, Eclipse, VSâ€¯Codeâ€”chá»n báº¥t ká»³ cÃ¡i nÃ o báº¡n cáº£m tháº¥y thoáº£i mÃ¡i).

ÄÃ³ lÃ  táº¥t cáº£. KhÃ´ng cáº§n plugin Maven bá»• sung, khÃ´ng cáº§n cÃ´ng cá»¥ bÃªn ngoÃ i. Chá»‰ cáº§n thÆ° viá»‡n cá»‘t lÃµi vÃ  má»™t chÃºt mÃ£.

![Illustration of setting recovery mode in Aspose.Words Java API](/images/set-recovery-mode-java.png){.align-center alt="set recovery mode"}

## BÆ°á»›c 1 â€“ Táº¡o Má»™t Äá»‘i TÆ°á»£ng `LoadOptions`

Äiá»u Ä‘áº§u tiÃªn báº¡n lÃ m lÃ  khá»Ÿi táº¡o má»™t Ä‘á»‘i tÆ°á»£ng `LoadOptions`. HÃ£y nghÄ© nÃ³ nhÆ° má»™t há»™p cÃ´ng cá»¥ cho Aspose.Words **Ä‘á»ƒ biáº¿t cÃ¡ch xá»­ lÃ½ tá»‡p Ä‘áº¿n**.

```java
import com.aspose.words.LoadOptions;

// Step 1: Create LoadOptions with default settings
LoadOptions loadOptions = new LoadOptions();
```

Táº¡i sao khÃ´ng bá» qua bÆ°á»›c nÃ y? Bá»Ÿi vÃ¬ náº¿u khÃ´ng cÃ³ `LoadOptions` báº¡n khÃ´ng thá»ƒ chá»‰ Ä‘á»‹nh cho thÆ° viá»‡n ráº±ng báº¡n muá»‘n **sá»­ dá»¥ng cháº¿ Ä‘á»™ phá»¥c há»“i** hay khÃ´ng. HÃ nh vi máº·c Ä‘á»‹nh lÃ  strict, nghÄ©a lÃ  báº¥t ká»³ sá»± há»ng nÃ o cÅ©ng sáº½ dá»«ng quÃ¡ trÃ¬nh táº£i.

## BÆ°á»›c 2 â€“ Chá»n Cháº¿ Äá»™ Phá»¥c Há»“i PhÃ¹ Há»£p

Aspose.Words cung cáº¥p hai giÃ¡ trá»‹ enum:

| Cháº¿ Äá»™ | Chá»©c NÄƒng |
|------|--------------|
| `RecoveryMode.Tolerant` | Cá»‘ gáº¯ng cá»©u cÃ ng nhiá»u cÃ ng tá»‘t. PhÃ¹ há»£p cho cÃ¡c ká»‹ch báº£n *recover damaged word* khi chá»‰ cÃ³ má»™t style thiáº¿u hoáº·c má»™t má»‘i quan há»‡ bá»‹ há»ng. |
| `RecoveryMode.Strict`   | Dá»«ng ngay khi gáº·p báº¥t ká»³ váº¥n Ä‘á» nÃ o. DÃ¹ng khi báº¡n cáº§n Ä‘áº£m báº£o tÃ i liá»‡u hoÃ n toÃ n sáº¡ch sáº½ trÆ°á»›c khi tiáº¿p tá»¥c xá»­ lÃ½. |

Äáº·t cháº¿ Ä‘á»™ báº±ng má»™t dÃ²ng duy nháº¥t:

```java
import com.aspose.words.RecoveryMode;

// Step 2: Tell the loader to be forgiving
loadOptions.setRecoveryMode(RecoveryMode.Tolerant); // or RecoveryMode.Strict
```

**Táº¡i sao Ä‘iá»u nÃ y quan trá»ng:** Khi báº¡n **sá»­ dá»¥ng cháº¿ Ä‘á»™ phá»¥c há»“i**, thÆ° viá»‡n sáº½ tá»± Ä‘á»™ng vÃ¡ cÃ¡c pháº§n bá»‹ há»ng, xÃ¢y dá»±ng láº¡i cÃ¡c nÃºt XML thiáº¿u vÃ  tráº£ vá» má»™t Ä‘á»‘i tÆ°á»£ng `Document` cÃ³ thá»ƒ sá»­ dá»¥ng. Trong cháº¿ Ä‘á»™ *strict* báº¡n sáº½ nháº­n Ä‘Æ°á»£c `InvalidFormatException` thay vÃ¬ váº­y.

## BÆ°á»›c 3 â€“ Táº£i TÃ i Liá»‡u Vá»›i CÃ¡c TÃ¹y Chá»n Cá»§a Báº¡n

BÃ¢y giá» báº¡n cuá»‘i cÃ¹ng truyá»n tá»‡p cho Aspose.Words, kÃ¨m theo `LoadOptions` mÃ  báº¡n vá»«a cáº¥u hÃ¬nh.

```java
import com.aspose.words.Document;

// Step 3: Load the (potentially corrupted) DOCX
String filePath = "C:/Documents/corrupted.docx";
Document doc = new Document(filePath, loadOptions);
```

Náº¿u tá»‡p chá»‰ bá»‹ há»ng nháº¹, `doc` sáº½ lÃ  má»™t Ä‘á»‘i tÆ°á»£ng `Document` hoáº¡t Ä‘á»™ng Ä‘áº§y Ä‘á»§. Báº¡n cÃ³ thá»ƒ:

- Äá»c vÄƒn báº£n (`doc.getText()`),
- LÆ°u sang Ä‘á»‹nh dáº¡ng khÃ¡c (`doc.save("repaired.pdf")`),
- Hoáº·c tháº­m chÃ­ kiá»ƒm tra danh sÃ¡ch cÃ¡c pháº§n Ä‘Ã£ Ä‘Æ°á»£c khÃ´i phá»¥c qua API `Document`.

### XÃ¡c Nháº­n Viá»‡c Phá»¥c Há»“i

Má»™t kiá»ƒm tra nhanh giÃºp báº¡n cháº¯c cháº¯n ráº±ng viá»‡c phá»¥c há»“i Ä‘Ã£ thÃ nh cÃ´ng:

```java
if (doc.getSections().getCount() > 0) {
    System.out.println("Document loaded successfully â€“ recovery mode worked!");
} else {
    System.out.println("No sections found â€“ the file might be beyond repair.");
}
```

## BÆ°á»›c 4 â€“ Xá»­ LÃ½ CÃ¡c TrÆ°á»ng Há»£p GÃ³c

### 4.1 Khi Tolerant KhÃ´ng Äá»§

ÄÃ´i khi tá»‡p bá»‹ há»ng Ä‘áº¿n má»©c ngay cáº£ cháº¿ Ä‘á»™ **Tolerant** cÅ©ng khÃ´ng thá»ƒ ghÃ©p láº¡i (vÃ­ dá»¥, XML lÃµi bá»‹ thiáº¿u). Trong nhá»¯ng trÆ°á»ng há»£p hiáº¿m hoi nÃ y, báº¡n cÃ³ thá»ƒ:

1. **Thá»­ táº£i láº¡i láº§n thá»© hai vá»›i `RecoveryMode.Strict`** Ä‘á»ƒ xem thÃ´ng bÃ¡o lá»—i cÃ³ cung cáº¥p chi tiáº¿t hÆ¡n khÃ´ng.
2. **Sá»­ dá»¥ng cÃ´ng cá»¥ zip** Ä‘á»ƒ tá»± tay giáº£i nÃ©n cÃ¡c pháº§n XML vÃ  sá»­a chÃºng.
3. **Ghi láº¡i ngoáº¡i lá»‡** vÃ  thÃ´ng bÃ¡o cho ngÆ°á»i dÃ¹ng ráº±ng tÃ i liá»‡u khÃ´ng thá»ƒ khÃ´i phá»¥c.

```java
try {
    loadOptions.setRecoveryMode(RecoveryMode.Tolerant);
    Document doc = new Document(filePath, loadOptions);
    // proceed with doc
} catch (Exception e) {
    System.err.println("Tolerant mode failed: " + e.getMessage());
    // optional: retry with Strict or alert the user
}
```

### 4.2 CÃ¢n Nháº¯c Vá» Bá»™ Nhá»›

Viá»‡c táº£i cÃ¡c tá»‡p DOCX lá»›n vá»›i cháº¿ Ä‘á»™ phá»¥c há»“i báº­t cÃ³ thá»ƒ táº¡m thá»i tÄƒng gáº¥p Ä‘Ã´i má»©c sá»­ dá»¥ng bá»™ nhá»› vÃ¬ Aspose.Words giá»¯ cáº£ cáº¥u trÃºc gá»‘c vÃ  cáº¥u trÃºc Ä‘Ã£ sá»­a trong bá»™ nhá»›. Náº¿u báº¡n xá»­ lÃ½ cÃ¡c lÃ´ lá»›n:

- **TÃ¡i sá»­ dá»¥ng cÃ¹ng má»™t thá»ƒ hiá»‡n `LoadOptions`** thay vÃ¬ táº¡o má»›i má»—i láº§n.
- **Giáº£i phÃ³ng `Document`** (`doc.close()`) ngay khi xong.
- **Cháº¡y trÃªn JVM cÃ³ Ä‘á»§ heap** (`-Xmx2g` hoáº·c cao hÆ¡n cho cÃ¡c tá»‡p Ä‘a gigabyte).

### 4.3 LÆ°u Tá»‡p ÄÃ£ Sá»­a

Sau khi táº£i thÃ nh cÃ´ng, báº¡n cÃ³ thá»ƒ muá»‘n **lÆ°u phiÃªn báº£n Ä‘Ã£ lÃ m sáº¡ch** Ä‘á»ƒ khÃ´ng cáº§n cháº¡y phá»¥c há»“i láº¡i.

```java
String repairedPath = "C:/Documents/repaired.docx";
doc.save(repairedPath);
System.out.println("Repaired file saved to: " + repairedPath);
```

BÃ¢y giá» láº§n sau khi má»Ÿ `repaired.docx` báº¡n cÃ³ thá»ƒ bá» qua bÆ°á»›c **use recovery mode** hoÃ n toÃ n.

## CÃ¢u Há»i ThÆ°á»ng Gáº·p

**H: Äiá»u nÃ y cÃ³ hoáº¡t Ä‘á»™ng vá»›i cÃ¡c tá»‡p `.doc` cÅ© khÃ´ng?**  
Ä: CÃ³. CÃ¡ch tiáº¿p cáº­n `LoadOptions` tÆ°Æ¡ng tá»± Ã¡p dá»¥ng cho `.doc` vÃ  `.rtf`. Chá»‰ cáº§n thay Ä‘á»•i pháº§n má»Ÿ rá»™ng tá»‡p.

**H: TÃ´i cÃ³ thá»ƒ káº¿t há»£p `setRecoveryMode` vá»›i cÃ¡c tÃ¹y chá»n táº£i khÃ¡c (vÃ­ dá»¥, máº­t kháº©u) khÃ´ng?**  
Ä: Cháº¯c cháº¯n. `LoadOptions` cÃ³ cÃ¡c thuá»™c tÃ­nh nhÆ° `setPassword` vÃ  `setLoadFormat`. Äáº·t chÃºng trÆ°á»›c khi gá»i `setRecoveryMode`.

**H: CÃ³ báº¥t ká»³ chi phÃ­ hiá»‡u nÄƒng nÃ o khÃ´ng?**  
Ä: CÃ³ chÃºtâ€”phá»¥c há»“i thÃªm má»™t bÆ°á»›c phÃ¢n tÃ­ch. Trong cÃ¡c bÃ i kiá»ƒm tra, tá»‡p 5â€¯MB bá»‹ há»ng táº£i khoáº£ng **30â€¯%** cháº­m hÆ¡n á»Ÿ cháº¿ Ä‘á»™ **Tolerant** so vá»›i táº£i strict cá»§a tá»‡p sáº¡ch. Váº«n cháº¥p nháº­n Ä‘Æ°á»£c cho háº§u háº¿t cÃ¡c cÃ´ng viá»‡c batch.

## VÃ­ Dá»¥ HoÃ n Chá»‰nh

DÆ°á»›i Ä‘Ã¢y lÃ  má»™t lá»›p Java Ä‘áº§y Ä‘á»§, sáºµn sÃ ng cháº¡y, minh há»a **cÃ¡ch má»Ÿ docx**, **sá»­ dá»¥ng cháº¿ Ä‘á»™ phá»¥c há»“i**, vÃ  **lÆ°u báº£n sao Ä‘Ã£ sá»­a**.

```java
package com.example.recovery;

import com.aspose.words.*;

public class RecoverCorruptedDocx {
    public static void main(String[] args) {
        // Path to the possibly corrupted DOCX
        String inputPath = "C:/Documents/corrupted.docx";
        // Where the repaired file will be saved
        String outputPath = "C:/Documents/repaired.docx";

        // 1ï¸âƒ£ Create LoadOptions
        LoadOptions loadOptions = new LoadOptions();

        // 2ï¸âƒ£ Choose recovery mode â€“ Tolerant is usually enough
        loadOptions.setRecoveryMode(RecoveryMode.Tolerant);
        // If you need strict validation, switch to RecoveryMode.Strict

        try {
            // 3ï¸âƒ£ Load the document with the configured options
            Document doc = new Document(inputPath, loadOptions);

            // Quick sanity check
            if (doc.getSections().getCount() > 0) {
                System.out.println("âœ… Document loaded â€“ recovery succeeded.");
            } else {
                System.out.println("âš ï¸ No sections found â€“ the file may be beyond repair.");
            }

            // 4ï¸âƒ£ (Optional) Save a clean copy for future use
            doc.save(outputPath);
            System.out.println("ğŸ’¾ Repaired file saved to: " + outputPath);
        } catch (Exception e) {
            // Handle cases where even tolerant mode fails
            System.err.println("âŒ Failed to load document: " + e.getMessage());
            // You could retry with Strict or log for further analysis
        }
    }
}
```

Cháº¡y lá»›p nÃ y sau khi thÃªm JAR Aspose.Words for Java vÃ o classpath cá»§a dá»± Ã¡n. Náº¿u tá»‡p Ä‘áº§u vÃ o chá»‰ bá»‹ há»ng má»™t chÃºt, báº¡n sáº½ tháº¥y thÃ´ng bÃ¡o **âœ…** vÃ  má»™t tá»‡p `repaired.docx` má»›i trÃªn Ä‘Ä©a.

## Káº¿t Luáº­n

ChÃºng ta Ä‘Ã£ bao quÃ¡t má»i thá»© báº¡n cáº§n Ä‘á»ƒ **Ä‘áº·t cháº¿ Ä‘á»™ phá»¥c há»“i** vÃ  má»Ÿ thÃ nh cÃ´ng cÃ¡c tá»‡p **corrupted word** trong Java. Báº±ng cÃ¡ch táº¡o má»™t Ä‘á»‘i tÆ°á»£ng `LoadOptions`, chá»n `RecoveryMode` phÃ¹ há»£p, vÃ  xá»­ lÃ½ cÃ¡c trÆ°á»ng há»£p gÃ³c thá»‰nh thoáº£ng xuáº¥t hiá»‡n, báº¡n cÃ³ thá»ƒ biáº¿n má»™t khoáº£nh kháº¯c â€œtá»‡p khÃ´ng má»Ÿ Ä‘Æ°á»£câ€ thÃ nh quy trÃ¬nh phá»¥c há»“i suÃ´n sáº».

Nhá»› ráº±ng:

- **Tolerant** lÃ  lá»±a chá»n máº·c Ä‘á»‹nh cho háº§u háº¿t cÃ¡c ká»‹ch báº£n *recover damaged word*.
- **Strict** cho báº¡n má»™t lá»—i nghiÃªm ngáº·t khi cáº§n Ä‘á»™ cháº¯c cháº¯n tuyá»‡t Ä‘á»‘i.
- LuÃ´n xÃ¡c minh tÃ i liá»‡u Ä‘Ã£ táº£i vÃ , náº¿u cÃ³ thá»ƒ, lÆ°u báº£n sao sáº¡ch Ä‘á»ƒ dÃ¹ng trong cÃ¡c láº§n cháº¡y sau.

BÃ¢y giá» báº¡n cÃ³ thá»ƒ tá»± tin tráº£ lá»i â€œ**cÃ¡ch má»Ÿ docx** mÃ  khÃ´ng má»Ÿ Ä‘Æ°á»£c?â€ báº±ng má»™t Ä‘oáº¡n mÃ£ cá»¥ thá»ƒ vÃ  giáº£i thÃ­ch rÃµ rÃ ng. ChÃºc báº¡n láº­p trÃ¬nh vui váº», vÃ  mong tÃ i liá»‡u cá»§a báº¡n luÃ´n khá»e máº¡nh!

{{< /blocks/products/pf/tutorial-page-section >}}
{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}
{{< blocks/products/products-backtop-button >}}