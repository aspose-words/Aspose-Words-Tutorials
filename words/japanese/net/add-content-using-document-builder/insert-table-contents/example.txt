//ExStart
//ExSummaryをクリックします。 このコードは、ドキュメントビルダーを使用して、 Word ドキュメントを作成する方法を示します。さまざまなレベルの見出しを含めて、ドキュメントを .docx ファイルとして保存します。
//ExStepSummary:0: このステップは、新しいドキュメントオブジェクトを初期化します。
//ExStepSummary:1: このステップによって、ドキュメント操作のためのドキュメントビルダーオブジェクトが作成されます。
//ExStepSummary:2: このステップは、ドキュメントの先頭に目次を挿入します。
//ExStepSummary:3: このステップは、新しいページ上の実際のコンテンツの開始時に、ページブレークを導入します。
//ExStepSummary:4: このステップは、最初の見出しを設定し、ドキュメントに「ハイジ 1」を書き込みます。
//ExStepSummary:5: このステップは,2番目の見出しレベルを設定し,"heading 1."と"heading 1.2"を書き込みます.
//ExStepSummary:6: このステップは、最初の見出しレベルを再び設定し、"heading 2"と"heading 3"を書き込みます。
//ExStepSummary:7: このステップは、2番目の見出しレベルを設定し、"heading 3.1"を書き込みます。
//ExStepSummary:8: このステップは,第三十一条の見出しレベルを設定し,同条の見出しレベルを"Heading 3.1","heading 3.1.2","heading 3.1.3"と表記する.
//ExStepSummary:9: このステップは、2番目の見出しレベルをもう一度設定し、"heading 3.2"と"heading 3.3"を書き込みます。
//ExStepSummary:10: 最後に、このステップはドキュメント中のフィールドを更新し、.docx ファイルとして保存します。
//ExStepImage:3:images/1.png
//ExStepImage:4:images/2.png
//ExStepImage:5:images/3.png
//ExStepImage:6:images/4.png
//ExStepImage:7:images/5.png
//ExStepImage:8:images/6.png
//ExStepImage:9:images/7.png

//ExStep:0-
// 新しい文書インスタンスを作成
Document doc = new Document();

//ExStep:1-
// ドキュメント操作用の文書ビルダーを初期化
DocumentBuilder builder = new DocumentBuilder(doc);

//ExStep:2-
// 目次を指定したオプションで挿入
builder.InsertTableOfContents("\\o \"1-3\" \\h \\z \\u");

//ExStep:3-
// ページブレークを挿入し、新しいページ上でコンテンツを起動する
builder.InsertBreak(BreakType.PageBreak);

//ExStep:4-
// スタイルを見出し 1 に設定
builder.ParagraphFormat.StyleIdentifier = StyleIdentifier.Heading1;
builder.Writeln("Heading 1");

//ExStep:5-
// スタイルを見出し 2 に設定
builder.ParagraphFormat.StyleIdentifier = StyleIdentifier.Heading2;
builder.Writeln("Heading 1.1");
builder.Writeln("Heading 1.2");

//ExStep:6-
// スタイルを見出し 1 に戻します
builder.ParagraphFormat.StyleIdentifier = StyleIdentifier.Heading1;
builder.Writeln("Heading 2");
builder.Writeln("Heading 3");

//ExStep:7-
// スタイルを見出し 2 に設定
builder.ParagraphFormat.StyleIdentifier = StyleIdentifier.Heading2;
builder.Writeln("Heading 3.1");

//ExStep:8-
// スタイルを見出し 3 に設定
builder.ParagraphFormat.StyleIdentifier = StyleIdentifier.Heading3;
builder.Writeln("Heading 3.1.1");
builder.Writeln("Heading 3.1.2");
builder.Writeln("Heading 3.1.3");

//ExStep:9-
// スタイルを見出し 2 に戻します
builder.ParagraphFormat.StyleIdentifier = StyleIdentifier.Heading2;
builder.Writeln("Heading 3.2");
builder.Writeln("Heading 3.3");

//ExStep:10-
// ドキュメントのすべてのフィールドを更新します
doc.UpdateFields();
// ドキュメントを保存します
doc.Save("AddContentUsingDocumentBuilder.InsertTableOfContents.docx");
//ExEnd