---
"description": "Μάθετε πώς να τροποποιείτε ετικέτες δομημένων εγγράφων στο Word χρησιμοποιώντας το Aspose.Words για .NET. Ενημερώστε κείμενο, αναπτυσσόμενα μενού και εικόνες βήμα προς βήμα."
"linktitle": "Τροποποίηση στοιχείων ελέγχου περιεχομένου"
"second_title": "API επεξεργασίας εγγράφων Aspose.Words"
"title": "Τροποποίηση στοιχείων ελέγχου περιεχομένου"
"url": "/el/net/programming-with-sdt/modify-content-controls/"
"weight": 10
---

{{< blocks/products/pf/main-wrap-class >}}

{{< blocks/products/pf/main-container >}}

{{< blocks/products/pf/tutorial-page-section >}}

# Τροποποίηση στοιχείων ελέγχου περιεχομένου

## Εισαγωγή

Αν έχετε εργαστεί ποτέ με έγγραφα του Word και χρειάστηκε να τροποποιήσετε στοιχεία ελέγχου δομημένου περιεχομένου — όπως απλό κείμενο, αναπτυσσόμενες λίστες ή εικόνες — χρησιμοποιώντας το Aspose.Words για .NET, βρίσκεστε στο σωστό μέρος! Οι ετικέτες δομημένων εγγράφων (SDT) είναι ισχυρά εργαλεία που κάνουν την αυτοματοποίηση εγγράφων ευκολότερη και πιο ευέλικτη. Σε αυτό το σεμινάριο, θα εμβαθύνουμε στο πώς μπορείτε να τροποποιήσετε αυτά τα SDT ώστε να ταιριάζουν στις ανάγκες σας. Είτε ενημερώνετε κείμενο, αλλάζετε επιλογές αναπτυσσόμενων μενού είτε ανταλλάσσετε εικόνες, αυτός ο οδηγός θα σας καθοδηγήσει στη διαδικασία βήμα προς βήμα.

## Προαπαιτούμενα

Πριν προχωρήσουμε στις λεπτομέρειες της τροποποίησης των στοιχείων ελέγχου περιεχομένου, βεβαιωθείτε ότι έχετε τα εξής:

1. Εγκατεστημένο Aspose.Words για .NET: Βεβαιωθείτε ότι έχετε εγκαταστήσει τη βιβλιοθήκη Aspose.Words. Εάν όχι, μπορείτε να [κατεβάστε το εδώ](https://releases.aspose.com/words/net/).

2. Βασικές γνώσεις C#: Αυτό το σεμινάριο προϋποθέτει ότι είστε εξοικειωμένοι με βασικές έννοιες προγραμματισμού C#.

3. Ένα περιβάλλον ανάπτυξης .NET: Θα πρέπει να έχετε ρυθμίσει ένα IDE όπως το Visual Studio για την εκτέλεση εφαρμογών .NET.

4. Ένα δείγμα εγγράφου: Θα χρησιμοποιήσουμε ένα δείγμα εγγράφου Word με διάφορους τύπους SDT. Μπορείτε να χρησιμοποιήσετε αυτό από το παράδειγμα ή να δημιουργήσετε το δικό σας.

5. Πρόσβαση στην τεκμηρίωση του Aspose: Για πιο λεπτομερείς πληροφορίες, ανατρέξτε στο [Τεκμηρίωση Aspose.Words](https://reference.aspose.com/words/net/).

## Εισαγωγή χώρων ονομάτων

Για να ξεκινήσετε να εργάζεστε με το Aspose.Words, πρέπει να εισαγάγετε τους σχετικούς χώρους ονομάτων στο έργο σας σε C#. Δείτε πώς μπορείτε να το κάνετε:

```csharp
using Aspose.Words;
using Aspose.Words.Drawing;
using Aspose.Words.Tables;
```

Αυτοί οι χώροι ονομάτων θα σας δώσουν πρόσβαση στις κλάσεις και τις μεθόδους που είναι απαραίτητες για τον χειρισμό ετικετών δομημένων εγγράφων στα έγγραφά σας στο Word.

## Βήμα 1: Ρύθμιση της διαδρομής του εγγράφου σας

Πριν κάνετε οποιεσδήποτε αλλαγές, πρέπει να καθορίσετε τη διαδρομή προς το έγγραφό σας. Αντικατάσταση `"YOUR DOCUMENT DIRECTORY"` με την πραγματική διαδρομή όπου είναι αποθηκευμένο το έγγραφό σας.

```csharp
string dataDir = "YOUR DOCUMENT DIRECTORY";
Document doc = new Document(dataDir + "Structured document tags.docx");
```

## Βήμα 2: Επανάληψη ετικετών δομημένου εγγράφου

Για να τροποποιήσετε τα SDT, πρέπει πρώτα να κάνετε επανάληψη σε όλα τα SDT στο έγγραφο. Αυτό γίνεται χρησιμοποιώντας το `GetChildNodes` μέθοδος για να λάβετε όλους τους κόμβους του τύπου `StructuredDocumentTag`.

```csharp
foreach (StructuredDocumentTag sdt in doc.GetChildNodes(NodeType.StructuredDocumentTag, true))
{
    // Τροποποιήστε τα SDT με βάση τον τύπο τους
}
```

## Βήμα 3: Τροποποίηση απλών SDT κειμένου

Εάν το SDT είναι απλό κείμενο, μπορείτε να αντικαταστήσετε το περιεχόμενό του. Αρχικά, διαγράψτε το υπάρχον περιεχόμενο και, στη συνέχεια, προσθέστε νέο κείμενο.

```csharp
if (sdt.SdtType == SdtType.PlainText)
{
    sdt.RemoveAllChildren();
    Paragraph para = sdt.AppendChild(new Paragraph(doc)) as Paragraph;
    Run run = new Run(doc, "new text goes here");
    para.AppendChild(run);
}
```

Εξήγηση: Εδώ, `RemoveAllChildren()` διαγράφει το υπάρχον περιεχόμενο του SDT. Στη συνέχεια, δημιουργούμε ένα νέο `Paragraph` και `Run` αντικείμενο για την εισαγωγή του νέου κειμένου.

## Βήμα 4: Τροποποίηση αναπτυσσόμενης λίστας SDT

Για αναπτυσσόμενες λίστες SDT, μπορείτε να αλλάξετε το επιλεγμένο στοιχείο αποκτώντας πρόσβαση στο `ListItems` συλλογή. Εδώ, επιλέγουμε το τρίτο στοιχείο της λίστας.

```csharp
if (sdt.SdtType == SdtType.DropDownList)
{
    SdtListItem secondItem = sdt.ListItems[2];
    sdt.ListItems.SelectedValue = secondItem;
}
```

Εξήγηση: Αυτό το απόσπασμα κώδικα επιλέγει το στοιχείο στο ευρετήριο 2 (τρίτο στοιχείο) από την αναπτυσσόμενη λίστα. Προσαρμόστε το ευρετήριο με βάση τις ανάγκες σας.

## Βήμα 5: Τροποποίηση SDT εικόνας

Για να ενημερώσετε μια εικόνα μέσα σε ένα SDT εικόνας, μπορείτε να αντικαταστήσετε την υπάρχουσα εικόνα με μια νέα.

```csharp
if (sdt.SdtType == SdtType.Picture)
{
    Shape shape = (Shape) sdt.GetChild(NodeType.Shape, 0, true);
    if (shape.HasImage)
    {
        shape.ImageData.SetImage(ImagesDir + "Watermark.png");
    }
}
```

Εξήγηση: Αυτός ο κώδικας ελέγχει εάν το σχήμα περιέχει μια εικόνα και στη συνέχεια την αντικαθιστά με μια νέα εικόνα που βρίσκεται στη διεύθυνση `ImagesDir`.

## Βήμα 6: Αποθηκεύστε το τροποποιημένο έγγραφό σας

Αφού κάνετε όλες τις απαραίτητες αλλαγές, αποθηκεύστε το τροποποιημένο έγγραφο με νέο όνομα για να διατηρήσετε το αρχικό σας έγγραφο άθικτο.

```csharp
doc.Save(dataDir + "WorkingWithSdt.ModifyContentControls.docx");
```

Εξήγηση: Αυτό αποθηκεύει το έγγραφο με ένα νέο όνομα αρχείου, ώστε να μπορείτε εύκολα να το διαφοροποιήσετε από το πρωτότυπο.

## Σύναψη

Η τροποποίηση των στοιχείων ελέγχου περιεχομένου σε ένα έγγραφο του Word χρησιμοποιώντας το Aspose.Words για .NET είναι απλή υπόθεση μόλις κατανοήσετε τα βήματα που εμπλέκονται. Είτε ενημερώνετε κείμενο, είτε αλλάζετε επιλογές αναπτυσσόμενου μενού είτε ανταλλάσσετε εικόνες, το Aspose.Words παρέχει ένα ισχυρό API για αυτές τις εργασίες. Ακολουθώντας αυτό το σεμινάριο, μπορείτε να διαχειριστείτε και να προσαρμόσετε αποτελεσματικά τα δομημένα στοιχεία ελέγχου περιεχομένου του εγγράφου σας, καθιστώντας τα έγγραφά σας πιο δυναμικά και προσαρμοσμένα στις ανάγκες σας.

## Συχνές ερωτήσεις

1. Τι είναι μια ετικέτα δομημένου εγγράφου (SDT);

Τα SDT είναι στοιχεία σε έγγραφα του Word που βοηθούν στη διαχείριση και τη μορφοποίηση περιεχομένου εγγράφων, όπως πλαίσια κειμένου, αναπτυσσόμενες λίστες ή εικόνες.

2. Πώς μπορώ να προσθέσω ένα νέο στοιχείο από αναπτυσσόμενη λίστα σε ένα SDT;

Για να προσθέσετε ένα νέο στοιχείο, χρησιμοποιήστε το `ListItems` ιδιότητα και προσθήκη μιας νέας `SdtListItem` προς τη συλλογή.

3. Μπορώ να χρησιμοποιήσω το Aspose.Words για να αφαιρέσω SDTs από ένα έγγραφο;

Ναι, μπορείτε να καταργήσετε τα SDT αποκτώντας πρόσβαση στους κόμβους του εγγράφου και διαγράφοντας το επιθυμητό SDT.

4. Πώς μπορώ να χειριστώ SDTs που είναι ένθετα μέσα σε άλλα στοιχεία;

Χρησιμοποιήστε το `GetChildNodes` μέθοδος με κατάλληλες παραμέτρους για πρόσβαση σε ένθετα SDT.

5. Τι πρέπει να κάνω εάν το SDT που πρέπει να τροποποιήσω δεν είναι ορατό στο έγγραφο;

Βεβαιωθείτε ότι το SDT δεν είναι κρυφό ή προστατευμένο. Ελέγξτε τις ρυθμίσεις του εγγράφου και βεβαιωθείτε ότι ο κώδικάς σας στοχεύει σωστά τον τύπο SDT.


### Παράδειγμα πηγαίου κώδικα για την τροποποίηση στοιχείων ελέγχου περιεχομένου χρησιμοποιώντας το Aspose.Words για .NET 

```csharp
// Διαδρομή προς τον κατάλογο εγγράφων σας 
string dataDir = "YOUR DOCUMENT DIRECTORY";

Document doc = new Document(dataDir + "Structured document tags.docx");
foreach (StructuredDocumentTag sdt in doc.GetChildNodes(NodeType.StructuredDocumentTag, true))
{
	switch (sdt.SdtType)
	{
		case SdtType.PlainText:
		{
			sdt.RemoveAllChildren();
			Paragraph para = sdt.AppendChild(new Paragraph(doc)) as Paragraph;
			Run run = new Run(doc, "new text goes here");
			para.AppendChild(run);
			break;
		}
		case SdtType.DropDownList:
		{
			SdtListItem secondItem = sdt.ListItems[2];
			sdt.ListItems.SelectedValue = secondItem;
			break;
		}
		case SdtType.Picture:
		{
			Shape shape = (Shape) sdt.GetChild(NodeType.Shape, 0, true);
			if (shape.HasImage)
			{
				shape.ImageData.SetImage(ImagesDir + "Watermark.png");
			}
			break;
		}
	}
}
doc.Save(dataDir + "WorkingWithSdt.ModifyContentControls.docx");

```

Αυτό ήταν! Τροποποιήσατε με επιτυχία διαφορετικούς τύπους στοιχείων ελέγχου περιεχομένου στο έγγραφο του Word χρησιμοποιώντας το Aspose.Words για .NET.

{{< /blocks/products/pf/tutorial-page-section >}}


{{< /blocks/products/pf/main-container >}}

{{< /blocks/products/pf/main-wrap-class >}}


{{< blocks/products/products-backtop-button >}}