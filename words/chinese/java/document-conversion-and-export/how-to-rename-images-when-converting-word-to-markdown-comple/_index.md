---
category: general
date: 2025-12-18
description: å­¦ä¹ åœ¨å°† Word æ–‡æ¡£è½¬æ¢ä¸º Markdown æ—¶å¦‚ä½•é‡å‘½åå›¾åƒï¼Œå¹¶æä¾›ä¸€æ­¥æ­¥çš„æŒ‡å—ï¼Œå¸®åŠ©é«˜æ•ˆåœ°å°† docx è½¬æ¢ä¸º Markdown
  å¹¶å¯¼å‡ºã€‚
draft: false
keywords:
- how to rename images
- convert word to markdown
- export docx to markdown
- how to convert docx
- how to extract images
language: zh
og_description: äº†è§£åœ¨ Word è½¬ Markdown è½¬æ¢è¿‡ç¨‹ä¸­å¦‚ä½•é‡å‘½åå›¾åƒï¼Œæä¾›å®Œæ•´çš„ä»£ç ç¤ºä¾‹ï¼Œæ¼”ç¤ºå°† docx å¯¼å‡ºä¸º Markdown å¹¶æå–å›¾åƒã€‚
og_title: å¦‚ä½•é‡å‘½åå›¾åƒ â€“ Word è½¬ Markdown è½¬æ¢æŒ‡å—
tags:
- Aspose.Words
- C#
- Markdown conversion
title: å°† Word è½¬æ¢ä¸º Markdown æ—¶å¦‚ä½•é‡å‘½åå›¾ç‰‡ â€“ å®Œæ•´æŒ‡å—
url: /zh/java/document-conversion-and-export/how-to-rename-images-when-converting-word-to-markdown-comple/
---

{{< blocks/products/pf/main-wrap-class >}}
{{< blocks/products/pf/main-container >}}
{{< blocks/products/pf/tutorial-page-section >}}

# å¦‚ä½•é‡å‘½åå›¾åƒ â€“ Word è½¬ Markdown å®Œæ•´æ•™ç¨‹

æœ‰æ²¡æœ‰æƒ³è¿‡åœ¨å°† Wordâ€¯.docx è½¬æ¢ä¸ºå¹²å‡€çš„ Markdown æ—¶ **å¦‚ä½•é‡å‘½åå›¾åƒ**ï¼Ÿä½ å¹¶ä¸å­¤å•ã€‚è®¸å¤šå¼€å‘è€…åœ¨é»˜è®¤çš„å›¾åƒåç§°å˜æˆä¸€å † GUID çš„ä¹±ä¸ƒå…«ç³Ÿæ—¶ä¼šå¡ä½ï¼Œè¿™ä¼šè®©æœ€ç»ˆçš„ Markdown éš¾ä»¥é˜…è¯»å’Œç»´æŠ¤ã€‚  

åœ¨æœ¬æŒ‡å—ä¸­ï¼Œæˆ‘ä»¬å°†æ¼”ç¤ºä¸€ä¸ªå®Œæ•´ä¸”å¯è¿è¡Œçš„è§£å†³æ–¹æ¡ˆï¼Œå®ƒä¸ä»… **å¦‚ä½•é‡å‘½åå›¾åƒ**ï¼Œè¿˜ä¼šå±•ç¤º **convert word to markdown**ã€**export docx to markdown**ï¼Œç”šè‡³ **how to extract images** ä»¥è¿›è¡Œå•ç‹¬å¤„ç†ã€‚ç»“æŸæ—¶ï¼Œä½ å°†æ‹¥æœ‰ä¸€ä¸ªå•æ–‡ä»¶ C# è„šæœ¬ï¼Œå…¨éƒ¨åŠŸèƒ½ä¸€æ¬¡æå®šâ€”â€”æ— éœ€é¢å¤–å·¥å…·ï¼Œæ— éœ€æ‰‹åŠ¨é‡å‘½åã€‚

> **å¿«é€Ÿé¢„è§ˆï¼š** æˆ‘ä»¬å°†ä½¿ç”¨ Aspose.Words for .NETï¼Œè®¾ç½® `MarkdownSaveOptions` å›è°ƒï¼Œå¹¶å°†æ¯ä¸ªåµŒå…¥çš„å›¾åƒé‡å‘½åä¸ºå”¯ä¸€ä¸”å¯è¯»çš„æ–‡ä»¶åã€‚æ‰€æœ‰ä»£ç å‡å¯ç›´æ¥å¤åˆ¶ç²˜è´´ä½¿ç”¨ã€‚

---

## ä½ å°†å­¦åˆ°

- **ä¸ºä½•é‡å‘½åå›¾åƒå¾ˆé‡è¦** â€“ å¯è¯»æ€§ã€SEO ä¸ç‰ˆæœ¬æ§åˆ¶ã€‚
- **å¦‚ä½•ä½¿ç”¨ Aspose.Words å°† Word è½¬æ¢ä¸º Markdown**ã€‚
- **å¦‚ä½•ä½¿ç”¨è‡ªå®šä¹‰èµ„æºå¤„ç†å¯¼å‡º DOCX ä¸º Markdown**ã€‚
- **å¦‚ä½•ä» DOCX ä¸­æå–å›¾åƒ** å¹¶å­˜å…¥è‡ªå®šä¹‰æ–‡ä»¶å¤¹ã€‚
- å®ç”¨æŠ€å·§ã€è¾¹ç¼˜æ¡ˆä¾‹å¤„ç†ä»¥åŠå®Œæ•´å¯è¿è¡Œç¤ºä¾‹ã€‚

**å…ˆå†³æ¡ä»¶**

- .NETâ€¯6.0 æˆ–æ›´é«˜ï¼ˆä»£ç åŒæ ·é€‚ç”¨äº .NETâ€¯Core ä¸ .NETâ€¯Frameworkï¼‰ã€‚
- Aspose.Words for .NET åº“ï¼ˆå…è´¹è¯•ç”¨ç‰ˆæˆ–æ­£å¼æˆæƒç‰ˆï¼‰ã€‚
- åŸºç¡€ C# çŸ¥è¯† â€“ åªè¦ä¼šå†™ `Console.WriteLine` å³å¯ã€‚

---

## åœ¨ Word è½¬ Markdown è¿‡ç¨‹ä¸­é‡å‘½åå›¾åƒ

è¿™æ˜¯æœ¬æ•™ç¨‹çš„æ ¸å¿ƒã€‚`MarkdownSaveOptions.ResourceSavingCallback` ä¸ºæ¯ä¸ªåµŒå…¥èµ„æºï¼ˆå›¾åƒã€éŸ³é¢‘ç­‰ï¼‰æä¾›äº†é’©å­ã€‚åœ¨å›è°ƒä¸­æˆ‘ä»¬ç”Ÿæˆæ–°æ–‡ä»¶åï¼Œå°†æµå†™å…¥ç£ç›˜ï¼Œå¹¶å‘ŠçŸ¥ Aspose ä½¿ç”¨æ–°çš„åç§°ã€‚

![How to rename images example â€“ screenshot of renamed image files](/images/how-to-rename-images-example.png "how to rename images during conversion")

### Stepâ€¯1: å®‰è£… Aspose.Words

å°† NuGet åŒ…æ·»åŠ åˆ°é¡¹ç›®ä¸­ï¼š

```bash
dotnet add package Aspose.Words
```

æˆ–é€šè¿‡åŒ…ç®¡ç†å™¨æ§åˆ¶å°ï¼š

```powershell
Install-Package Aspose.Words
```

### Stepâ€¯2: ä½¿ç”¨é‡å‘½åå›è°ƒå‡†å¤‡ MarkdownSaveOptions

```csharp
using System;
using System.IO;
using Aspose.Words;
using Aspose.Words.Saving;

// Define the folder where images will be saved
string imageFolder = Path.Combine(Environment.CurrentDirectory, "myImages");
Directory.CreateDirectory(imageFolder);

// Create Markdown save options
MarkdownSaveOptions mdOptions = new MarkdownSaveOptions();

// Set up the callback that runs for each embedded resource
mdOptions.ResourceSavingCallback = (resource, stream) =>
{
    // Only act on images â€“ other resources (like audio) are left untouched
    if (resource.Type == ResourceType.Image)
    {
        // Generate a friendly, unique name: img_<guid>.png
        string newFileName = $"img_{Guid.NewGuid():N}.png";

        // Build the full path and copy the stream
        string fullPath = Path.Combine(imageFolder, newFileName);
        using (FileStream file = new FileStream(fullPath, FileMode.Create, FileAccess.Write))
        {
            stream.CopyTo(file);
        }

        // Tell Aspose the new filename so the Markdown reference is correct
        resource.FileName = newFileName;
    }
};
```

**ä¸ºä»€ä¹ˆè¿™æ ·å¯è¡Œï¼š**  
- å›è°ƒæ¥æ”¶ä¸€ä¸ª `ResourceSavingArgs` å¯¹è±¡ï¼ˆ`resource`ï¼‰å’Œä¸€ä¸ª `Stream`ã€‚  
- é€šè¿‡æ£€æŸ¥ `resource.Type == ResourceType.Image` å¯ä»¥é¿å…å¯¹éå›¾åƒèµ„æºè¿›è¡Œå¤„ç†ã€‚  
- `Guid.NewGuid():N` ç”Ÿæˆä¸å¸¦è¿å­—ç¬¦çš„ 32 ä½åå…­è¿›åˆ¶å­—ç¬¦ä¸²ï¼Œç¡®ä¿å”¯ä¸€æ€§ã€‚  
- æ›´æ–° `resource.FileName` ä¼šé‡å†™ Markdown ä¸­çš„å›¾åƒé“¾æ¥ï¼ˆ`![](img_â€¦png)`ï¼‰ã€‚

### Stepâ€¯3: åŠ è½½ DOCX å¹¶ä¿å­˜ä¸º Markdown

```csharp
// Path to the source Word document
string docxPath = Path.Combine(Environment.CurrentDirectory, "input.docx");

// Load the document
Document doc = new Document(docxPath);

// Export to Markdown, applying our custom resource handling
string markdownPath = Path.Combine(Environment.CurrentDirectory, "output.md");
doc.Save(markdownPath, mdOptions);

Console.WriteLine($"Conversion complete! Markdown saved to {markdownPath}");
Console.WriteLine($"Images saved to {imageFolder}");
```

å°±è¿™ä¹ˆç®€å•ã€‚è¿è¡Œç¨‹åºåä¼šå¾—åˆ°ï¼š

- `output.md` â€“ å¹²å‡€çš„ Markdownï¼Œå›¾åƒå¼•ç”¨å½¢å¦‚ `![](img_1a2b3c4d5e6f7g8h9i0j1k2l3m4n5o6p.png)`ã€‚  
- ä¸€ä¸ªåä¸º `myImages` çš„æ–‡ä»¶å¤¹ï¼Œé‡Œé¢å­˜æ”¾ç€ä½¿ç”¨å‹å¥½åç§°çš„å›¾åƒæ–‡ä»¶ã€‚

---

## Convert Word to Markdown â€“ å®Œæ•´ç¤ºä¾‹

å¦‚æœä½ æ›´å–œæ¬¢å•æ–‡ä»¶è„šæœ¬ï¼Œå¤åˆ¶ä¸‹åˆ—ä»£ç åˆ° `Program.cs` å¹¶è¿è¡Œï¼š

```csharp
// Program.cs
using System;
using System.IO;
using Aspose.Words;
using Aspose.Words.Saving;

class Program
{
    static void Main()
    {
        // ---------- Configuration ----------
        string inputDocx = "YOUR_DIRECTORY/input.docx";
        string outputMd = "YOUR_DIRECTORY/output.md";
        string imagesDir = Path.Combine("YOUR_DIRECTORY", "myImages");
        Directory.CreateDirectory(imagesDir);

        // ---------- Step 1: Set up Markdown options ----------
        var mdOptions = new MarkdownSaveOptions();
        mdOptions.ResourceSavingCallback = (resource, stream) =>
        {
            if (resource.Type == ResourceType.Image)
            {
                string uniqueName = $"img_{Guid.NewGuid():N}.png";
                string destPath = Path.Combine(imagesDir, uniqueName);
                using (var file = new FileStream(destPath, FileMode.Create, FileAccess.Write))
                    stream.CopyTo(file);
                resource.FileName = uniqueName;
            }
        };

        // ---------- Step 2: Load DOCX ----------
        var doc = new Document(inputDocx);

        // ---------- Step 3: Save as Markdown ----------
        doc.Save(outputMd, mdOptions);

        Console.WriteLine($"âœ… Done! Markdown at {outputMd}");
        Console.WriteLine($"ğŸ–¼ï¸ Images saved in {imagesDir}");
    }
}
```

**å„ä»£ç å—è¯´æ˜**

| å— | ç›®çš„ |
|-------|---------|
| **Configuration** | é›†ä¸­ç®¡ç†è·¯å¾„ï¼Œåªéœ€ç¼–è¾‘ä¸€æ¬¡ã€‚ |
| **Stepâ€¯1** | åˆ›å»º `MarkdownSaveOptions` å¹¶è®¾ç½®é‡å‘½åå›è°ƒã€‚ |
| **Stepâ€¯2** | å°† `.docx` åŠ è½½åˆ° Aspose `Document` å¯¹è±¡ä¸­ã€‚ |
| **Stepâ€¯3** | ä½¿ç”¨è‡ªå®šä¹‰é€‰é¡¹è°ƒç”¨ `Save`ï¼ŒåŒæ—¶ç”Ÿæˆ Markdown ä¸å·²é‡å‘½åçš„å›¾åƒã€‚ |

è¿è¡Œæ–¹å¼ï¼š

```bash
dotnet run
```

ä½ åº”è¯¥ä¼šçœ‹åˆ°ä¸¤æ¡æ§åˆ¶å°æ¶ˆæ¯ï¼Œç¡®è®¤æˆåŠŸã€‚

---

## Export DOCX to Markdown â€“ ä¸ºä»€ä¹ˆè¿™ç§æ–¹å¼èƒœè¿‡æ‰‹åŠ¨å·¥å…·

- **è‡ªåŠ¨åŒ–** â€“ æ— éœ€æ‰“å¼€ Wordã€å¤åˆ¶ç²˜è´´å¹¶æ‰‹åŠ¨é‡å‘½åæ–‡ä»¶ã€‚  
- **ä¸€è‡´æ€§** â€“ æ¯ä¸ªå›¾åƒéƒ½æœ‰å¯é¢„æµ‹çš„å”¯ä¸€åç§°ï¼Œåˆ©äºç‰ˆæœ¬æ§åˆ¶ï¼ˆGit ä¸ä¼šå› ä¸º GUID å˜åŒ–è€Œè¯¯åˆ¤æ–‡ä»¶å·²æ›´æ”¹ï¼‰ã€‚  
- **å¯æ‰©å±•æ€§** â€“ é€‚ç”¨äºåŒ…å«æ•°åç”šè‡³æ•°ç™¾å¼ å›¾åƒçš„æ–‡æ¡£ï¼›å›è°ƒä¼šè‡ªåŠ¨ä¸ºæ¯ä¸ªèµ„æºè§¦å‘ã€‚  
- **å¯ç§»æ¤æ€§** â€“ ç”Ÿæˆçš„ Markdown å¯åœ¨ä»»ä½•é™æ€ç«™ç‚¹ç”Ÿæˆå™¨ï¼ˆJekyllã€Hugoã€MkDocsï¼‰ä¸­ä½¿ç”¨ï¼Œå› ä¸ºå›¾åƒé“¾æ¥æ˜¯ç›¸å¯¹ä¸”æ•´æ´çš„ã€‚

---

## How to Extract Images from a DOCX File (Bonus)

æœ‰æ—¶ä½ åªæƒ³è·å–åŸå§‹å›¾ç‰‡ï¼Œè€Œä¸æ˜¯ Markdown æ–‡ä»¶ã€‚ç›¸åŒçš„å›è°ƒå¯ä»¥å¤ç”¨ï¼Œæˆ–è€…ç›´æ¥ä½¿ç”¨ Aspose çš„ `Document` APIï¼š

```csharp
using Aspose.Words;
using System.IO;

// Load the document
Document doc = new Document("YOUR_DIRECTORY/input.docx");

// Iterate over all shapes (including inline images)
int imgCount = 0;
foreach (Shape shape in doc.GetChildNodes(NodeType.Shape, true))
{
    if (shape.HasImage)
    {
        imgCount++;
        string imgPath = Path.Combine("YOUR_DIRECTORY/extractedImages", $"extracted_{imgCount}.png");
        shape.ImageData.Save(imgPath);
    }
}
Console.WriteLine($"{imgCount} images extracted.");
```

**å…³é”®è¦ç‚¹**

- `NodeType.Shape` èƒ½æ•è·æµ®åŠ¨å’Œè¡Œå†…å›¾åƒã€‚  
- `shape.ImageData.Save` ç›´æ¥å°†äºŒè¿›åˆ¶å›¾åƒå†™å…¥ç£ç›˜ã€‚  
- è‹¥åŒæ—¶éœ€è¦ Markdown è¾“å‡ºï¼Œå¯å°†æ­¤ä»£ç ç‰‡æ®µä¸å‰é¢çš„è½¬æ¢é€»è¾‘åˆå¹¶ä½¿ç”¨ã€‚

---

## å®ç”¨æŠ€å·§ & å¸¸è§é™·é˜±

- **å‘½åå†²çªï¼š** ä½¿ç”¨ GUID åŸºæœ¬æ¶ˆé™¤äº†å†²çªï¼Œä½†å¦‚æœéœ€è¦æ›´å…·å¯è¯»æ€§çš„åç§°ï¼ˆå¦‚ `chapter1_figure2.png`ï¼‰ï¼Œå¯ä»¥ä» `resource.Name` æˆ–æ‰€åœ¨æ®µè½æ–‡æœ¬ä¸­æ´¾ç”Ÿã€‚  
- **å¤§æ–‡æ¡£ï¼š** æµç›´æ¥å†™å…¥ç£ç›˜ï¼›å¯¹äºè¶…å¤§æ–‡ä»¶ï¼Œè€ƒè™‘ä½¿ç”¨ç¼“å†²åŒºæˆ–å…ˆå†™å…¥ä¸´æ—¶ä½ç½®ã€‚  
- **é PNG å›¾åƒï¼š** ä¸Šé¢çš„å›è°ƒå¼ºåˆ¶ä½¿ç”¨ `.png` æ‰©å±•åã€‚å¦‚æœæºå›¾åƒæ˜¯ JPEGï¼Œå»ºè®®ä¿ç•™åŸå§‹æ ¼å¼ï¼š`Path.GetExtension(resource.FileName)` æˆ– `resource.ContentType`ã€‚  
- **æ€§èƒ½ï¼š** å›è°ƒåŒæ­¥æ‰§è¡Œã€‚å¦‚æœå¹¶è¡Œå¤„ç†å¤§é‡æ–‡æ¡£ï¼Œå¯å°†è½¬æ¢åŒ…è£…åœ¨ `Task.Run` ä¸­æˆ–ä½¿ç”¨çº¿ç¨‹æ± ï¼Œä»¥å…é˜»å¡ UIã€‚  
- **æˆæƒï¼š** Aspose.Words åœ¨è¯„ä¼°æ¨¡å¼ä¸‹ä¼šåœ¨è¾“å‡ºä¸­æ·»åŠ æ°´å°ã€‚è¯·æ”¾ç½®è®¸å¯è¯æ–‡ä»¶ (`Aspose.Words.lic`) ä»¥è·å¾—å¹²å‡€ç»“æœã€‚

---

## ç»“è®º

æˆ‘ä»¬å·²ç»å®Œæ•´æ¼”ç¤ºäº† **å¦‚ä½•åœ¨å°† Word æ–‡æ¡£è½¬æ¢ä¸º Markdown æ—¶é‡å‘½åå›¾åƒ**ï¼Œå±•ç¤ºäº† **convert word to markdown** çš„å…¨æµç¨‹ï¼Œè¯´æ˜äº† **export docx to markdown** çš„è‡ªå®šä¹‰èµ„æºå¤„ç†ï¼Œå¹¶è§£é‡Šäº† **how to extract images** çš„å®ç°æ–¹å¼ã€‚ä»£ç è‡ªåŒ…å«ã€ç°ä»£åŒ–ï¼Œå·²å‡†å¤‡å¥½æŠ•å…¥ç”Ÿäº§ä½¿ç”¨ã€‚

åŠ¨æ‰‹è¯•ä¸€è¯•â€”â€”å°†ä½ çš„ `.docx` æ”¾å…¥æŒ‡å®šæ–‡ä»¶å¤¹ï¼Œè¿è¡Œè„šæœ¬ï¼Œå³å¯çœ‹åˆ°æ•´æ´çš„ Markdown ä¸å‘½åå‹å¥½çš„å›¾åƒæ–‡ä»¶ã€‚ä¹‹åï¼Œä½ å¯ä»¥å°† Markdown æ¨é€åˆ°é™æ€ç«™ç‚¹ç”Ÿæˆå™¨ï¼Œæäº¤å›¾åƒåˆ° Gitï¼Œæˆ–å°†è¾“å‡ºæ¥å…¥æ–‡æ¡£æµæ°´çº¿ã€‚

å¦‚æœå¯¹è¾¹ç¼˜æ¡ˆä¾‹æœ‰ç–‘é—®ï¼Œæˆ–æƒ³æŠŠå®ƒé›†æˆåˆ° ASP.NET Core æœåŠ¡ä¸­ï¼Œæ¬¢è¿ç•™è¨€ï¼Œæˆ‘ä»¬ä¸€èµ·æ¢è®¨ã€‚ç¥è½¬æ¢æ„‰å¿«ï¼

{{< /blocks/products/pf/tutorial-page-section >}}
{{< /blocks/products/pf/main-container >}}
{{< /blocks/products/pf/main-wrap-class >}}
{{< blocks/products/products-backtop-button >}}